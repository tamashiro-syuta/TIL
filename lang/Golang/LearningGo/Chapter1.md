# Go環境のセットアップ

## goコマンド

### `go run`
- 内部的には以下の処理を行なっている。
  1. ビルドを行う
      - ビルド時に生成したバイナリファイルは一時的なディレクトリに保存される
  2. 生成した実行ファイルを実行する
  3. 生成したバイナリファイルを削除する

- ※ `go run`コマンドではインタプリタっぽく動くけど実際はちゃんとビルドしているよ✌️

### `go build`
- ビルドを行うだけ。生成されたバイナリファイルはカレントディレクトリに保存される。
- ※ 🚨 子や孫ディレクトリにあるファイルを指定しても、バイナリファイルが保存されるのはあくまでもコマンドを実行したカレントディレクトリなので注意
- `-o`オプションでバイナリファイルの名前を指定できる
  - 例: `go build -o 任意の名前 ビルドするファイル名.go`

### `go mod init モジュール名`
- モジュールを初期化するコマンド
- `go.mod`ファイルという`package.json`的なパッケージ管理をするファイルが生成される

### `go mod tidy`
- ソースファイルを解析して、必要なモジュールを自動で追加 && 不要なモジュールを自動で削除してくれる = 利用するモジュールを今あるコードに最適な感じにしてくれるやつ

### `go install パッケージ名`
- パッケージをインストールするコマンド
- Goのパッケージの公開方法は他の言語と異なる
  - よくある公開方法
    - プラットフォームに公開する = **"中央集権型"**
    - JavaScript: npmレジストリに公開
    - Java: Maven Centralに公開
  - Goの公開方法
    - パッケージをGitHubなどに公開する = **"分散型"**
    - ソースコードのリポジトリを介してパッケージをインストールする
- コマンド実行後に、`$GOPATH/bin`配下にパッケージのバイナリがインストールされる
- バージョンを指定してインストールしたい場合は、末尾に`@バージョン`をつける
  - 例: `go install github.com/gorilla/mux@v1.8.0`
- `go get`との違い
  - `go install`
    - `$GOPATH/bin`に **バイナリ** がインストールされる
    - `npm install -g`的なイメージ、全体で使いたい場合に使う
    - `go build`で生成した1つのバイナリにはパッケージのバイナリも一緒に含まれている
  - `go get`
    - `$GOPATH/src`に **ソースコード** がインストールされる
    - `npm install`的なイメージ、個別のプロジェクトで使いたい場合に使う

## Goの開発環境や互換性について
- **Goのプログラムはバイナリ形式なので、実行環境のランタイムに依存しない**
  - =「実行する場所を変えたから動かなくなった」がない
- Goは開発元のチームが **「互換性を重視している言語」** と公表している
- なので、積極的にバージョンアップしてOK
- 実際に著名なGoエンジニアは、Goのバージョン管理ツールなどは使用せず、都度PJに合わせてホストマシンに該当バージョンのGoをインストールしているらしい(これは聞いた話)
- ※ ただし、goコマンドのフラグや機能に関しては互換性が保たれないことがあるので注意

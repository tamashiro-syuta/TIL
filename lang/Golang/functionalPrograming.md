---
title: "関数型プログラミングとインターフェース"
tags: ["Go", "関数型プログラミング"]
---

**※ GPTに聴きながら格闘したやつを貼っていくので、間違っている可能性があり。ざっくりこんなものかくらいの温度感で見て。**

# 前提: 関数型とインターフェースってどう違うの？
## 関数型
- **「この引数にはこういう形の関数を渡してくださいね！」** と決められるもの。
  - 例: func(a int, b int) int みたいに、「引数や戻り値が具体的に決まっている場合」に便利。

## インターフェース
- **「この引数はこういう機能（メソッド）を持っているものならなんでもいいですよ！」** という考え方。
  - 例: ServeHTTP(w http.ResponseWriter, r *http.Request) というメソッドを持っているものを渡せる。


# どっちを使うべきか？

## 1. 関数型を使うのが良い場合
関数型を引数として渡すのが良い場合は、**「渡すのが関数だけ！」**というシンプルなケース。

### ポイント
- 「これこれこういう形の関数を1つ渡してもらえればOK」という場合は関数型で十分
- 例として、`sort.Slice`などがある

### 具体例: 関数型の活用
配列をソートするために「このルールで並び替えて！」と渡したいときは関数型を使う：

```go
package main
import (
    "fmt"
    "sort"
)

func main() {
    people := []string{"Alice", "Bob", "Charlie"}

    // NOTE: ここで、並び替えルールを関数型で渡している
    sort.Slice(people, func(i, j int) bool {
        return people[i] > people[j] // 降順に並び替えるルール
    })

    fmt.Println(people) // 出力: [Charlie Bob Alice]
}
```


## 2. インターフェースを使うのが良い場合
インターフェースを使うのが良いのは、「もっと汎用的な処理」をしたい場合です。

### ポイント
- 「いろんなオブジェクトを使いたいけど、最低限この機能（メソッド）を持っていればOK！」という場合にインターフェースが便利
- 例として、`http.Handler`などがある

### 具体例: インターフェースの活用
例えば、HTTPサーバーを作る場合、リクエストにどう対応するかをオブジェクトごとに自由に変えたいケースがあります。
そのとき、`http.Handler`インターフェースが使えます：

```go
package main

import (
	"fmt"
	"net/http"
)

// カスタムハンドラ
type MyHandler struct{}

// NOTE: 自分で好きなようにServeHTTPメソッドを実装すれば、HTTPリクエストに柔軟に対応できる！
func (h MyHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {
	fmt.Fprintln(w, "Hello, I'm a custom handler!")
}

func main() {
	// NOTE: ハンドラをインターフェースに適合させる
	http.Handle("/custom", MyHandler{})
	http.ListenAndServe(":8080", nil)
}
```


# まとめ

| 使うべきもの | こういう時に便利 |
|------------|----------------|
| 関数型 | シンプルな処理を渡すだけで済む時（例: 並び替えのルールを関数として渡すだけ） |
| インターフェース | 複数のオブジェクトや構造体を使いたい時（例: HTTPリクエストを処理する色々なハンドラを渡す） |
